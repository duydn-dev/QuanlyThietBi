<html>

<head>

    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/7.6.2/firebase-messaging.js"></script>

    <script>
        firebase.initializeApp({
            apiKey: 'AIzaSyDTAJ50kBzkIR6RcnNKlNbus5UaUuHEhAs',
            authDomain: 'bright-torus-246115.firebaseapp.com',
            databaseURL: 'https://bright-torus-246115.firebaseio.com',
            projectId: 'bright-torus-246115',
            storageBucket: 'bright-torus-246115.appspot.com',
            messagingSenderId: '394936780066',
            appId: '1:394936780066:web:3ec30dfa8874fdcd00117b'
            // measurementId: 'G-measurement-id'
        });

        // Notification.requestPermission().then(permission => {
        //     if (permission === 'granted') {
        //         console.log('Notification permission granted.');
        //         // TODO(developer): Retrieve an Instance ID token for use with FCM.
        //         // ...
        //     } else {
        //         console.log('Unable to get permission to notify.');
        //     }
        // });

        let messaging = firebase.messaging();


        // messaging.getToken()
        //     .then(currentToken => {
        //         console.log(currentToken);
        //         if (currentToken) {
        //             sendTokenToServer(currentToken);
        //             //updateUIForPushEnabled(currentToken);
        //         } else {
        //             // Show permission request.
        //             console.log(
        //                 'No Instance ID token available. Request permission to generate one.'
        //             );
        //             // Show permission UI.
        //             // updateUIForPushPermissionRequired();
        //             setTokenSentToServer(false);
        //         }
        //     })
        //     .catch(err => {
        //         console.log('An error occurred while retrieving token. ', err);
        //         //showToken('Error retrieving Instance ID token. ', err);
        //         this.setTokenSentToServer(false);
        //     });

        messaging.onMessage(payload => {
            console.log('Message received. ', payload);
            // ...
        });


        function setTokenSentToServer(sent) {
            window.localStorage.setItem('sentToServer', sent ? '1' : '0');
        }
        function sendTokenToServer(currentToken) {
            if (!isTokenSentToServer()) {
                console.log('Sending token to server...');
                // TODO(developer): Send the current token to your server.
                setTokenSentToServer(true);
            } else {
                console.log('Token already sent to server so won\'t send it again ' +
                    'unless it changes');
            }
        }
        function isTokenSentToServer() {
            return window.localStorage.getItem('sentToServer') === '1';
        }
    </script>
</head>

</html>